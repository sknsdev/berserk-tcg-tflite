# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏–∑ —Å–∫–∞–Ω–æ–≤ –∫–∞—Ä—Ç

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —Å–æ–∑–¥–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∫–∞—Ä—Ç Berserk TCG –∏–∑ –≤–∞—à–∏—Ö —Å–∫–∞–Ω–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–∏ —Å–∫–∞–Ω—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
```
berserk-tcg-tflite/
‚îú‚îÄ‚îÄ cards/
‚îÇ   ‚îú‚îÄ‚îÄ laar/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card1.webp
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card2.webp
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ s1/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card1.webp
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ s2/
‚îÇ   ‚îú‚îÄ‚îÄ s3/
‚îÇ   ‚îî‚îÄ‚îÄ s4/
‚îú‚îÄ‚îÄ data_preparation.py
‚îú‚îÄ‚îÄ data_augmentation.py
‚îú‚îÄ‚îÄ train_model_augmented.py
‚îî‚îÄ‚îÄ ...
```

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

```bash
python data_preparation.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫—É `cards/` –∏ –≤—Å–µ –ø–æ–¥–ø–∞–ø–∫–∏
- –ü–∞—Ä—Å–∏—Ç –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—Ä—Ç–∞—Ö
- –°–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª `cards_dataset.csv` —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç–Ω–∫–æ–¥–µ—Ä—ã –º–µ—Ç–æ–∫ –≤ `label_encoders.json`

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ `cards_dataset.csv` - –±–∞–∑–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç
- ‚úÖ `label_encoders.json` - —ç–Ω–∫–æ–¥–µ—Ä—ã –¥–ª—è –º–µ—Ç–æ–∫

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –∞—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

```bash
python data_augmentation.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É `cards_augmented/`
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç—ã
- –°–æ–∑–¥–∞–µ—Ç `augmented_cards_dataset.csv`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- –ü–æ–≤–æ—Ä–æ—Ç: ¬±15¬∞
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏: ¬±20%
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç–∏: ¬±20%
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞
- –õ–µ–≥–∫–æ–µ —Ä–∞–∑–º—ã—Ç–∏–µ
- –°–ª—É—á–∞–π–Ω–∞—è –æ–±—Ä–µ–∑–∫–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ `cards_augmented/` - –ø–∞–ø–∫–∞ —Å –∞—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- ‚úÖ `augmented_cards_dataset.csv` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç
- ‚úÖ `augmented_label_encoders.json` - –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —ç–Ω–∫–æ–¥–µ—Ä—ã

### –®–∞–≥ 3: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python train_model_augmented.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∞—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –°–æ–∑–¥–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ MobileNetV2
- –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞ (transfer learning + fine-tuning)
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª—å –≤ TensorFlow Lite —Ñ–æ—Ä–º–∞—Ç

**–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–±—É—á–µ–Ω–∏—è:**
1. **–ü—Ä–æ—Å—Ç–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç validation_split
2. **–° —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–æ–π** - —Å–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ `berserk_card_model_augmented.tflite` - –º–æ–¥–µ–ª—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ `berserk_card_model_augmented.h5` - –ø–æ–ª–Ω–∞—è Keras –º–æ–¥–µ–ª—å
- ‚úÖ `model_info_augmented.json` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏
- ‚úÖ `training_history_augmented.png` - –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "The least populated class in y has only 1 member"

**–ü—Ä–∏—á–∏–Ω–∞:** –í –¥–∞—Ç–∞—Å–µ—Ç–µ –µ—Å—Ç—å –∫–∞—Ä—Ç—ã —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º.

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π –≤ `data_augmentation.py`:
   ```python
   # –í –º–µ—Ç–æ–¥–µ create_augmented_dataset –∏–∑–º–µ–Ω–∏—Ç–µ:
   augmentations_per_image = 10  # –£–≤–µ–ª–∏—á—å—Ç–µ —Å 5 –¥–æ 10 –∏–ª–∏ –±–æ–ª—å—à–µ
   ```

2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ä–µ–¥–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤:
   ```python
   # –í train_model_augmented.py –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É
   # –∫–ª–∞—Å—Å–æ–≤ —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ GPU –ø–∞–º—è—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç–µ batch_size:
   ```python
   batch_size=16  # –í–º–µ—Å—Ç–æ 32
   ```

2. –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
   ```python
   target_size=(192, 192)  # –í–º–µ—Å—Ç–æ (224, 224)
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–≤–µ–ª–∏—á—å—Ç–µ dropout:
   ```python
   tf.keras.layers.Dropout(0.5)  # –í–º–µ—Å—Ç–æ 0.3
   ```

2. –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π
3. –£–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö

## üìä –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

```python
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ Python –∫–æ–Ω—Å–æ–ª–∏:
import pandas as pd
import numpy as np

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç
df = pd.read_csv('augmented_cards_dataset.csv')

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤
print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–µ—Ç–∞–º:")
print(df['set'].value_counts())

print("\n–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ä—Ç–∞–º:")
print(df['card_name'].value_counts().describe())

print("\n–ö–∞—Ä—Ç—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤:")
print(df['card_name'].value_counts().tail(10))
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è

- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –≤ `training_history_augmented.png`
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ validation accuracy –Ω–µ —Å–∏–ª—å–Ω–æ –æ—Ç—Å—Ç–∞–µ—Ç –æ—Ç training accuracy
- –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è, –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ —Ä–∞–Ω—å—à–µ

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –î–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏:

1. **–ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö:**
   - –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ –∫–∞—Ä—Ç—ã –≤ —Ä–∞–∑–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –æ—Å–≤–µ—â–µ–Ω–∏—è
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —É–≥–ª—ã —Å—ä–µ–º–∫–∏
   - –î–æ–±–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∫–∞—Ä—Ç –≤ —Ä—É–∫–∞–≤–∞—Ö

2. **–õ—É—á—à–∞—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - –î–æ–±–∞–≤—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã
   - –°–∏–º—É–ª–∏—Ä—É–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –æ—Å–≤–µ—â–µ–Ω–∏—è
   - –î–æ–±–∞–≤—å—Ç–µ —ç—Ñ—Ñ–µ–∫—Ç—ã —Ç–µ–Ω–µ–π –∏ –±–ª–∏–∫–æ–≤

3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏:**
   - –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–∞–∑–Ω—ã–º–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–Ω—Å–∞–º–±–ª–∏ –º–æ–¥–µ–ª–µ–π

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–æ–¥–µ–ª—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
   - –ò–∑–º–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –õ–æ–≥–∏—Ä—É–π—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å–ª—É—á–∞–∏ –Ω–µ—É–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
   - –°–æ–±–∏—Ä–∞–π—Ç–µ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Ñ–∞–π–ª `berserk_card_model_augmented.tflite`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö:

```python
# –ü—Ä–∏–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏
import tensorflow as tf

# –ó–∞–≥—Ä—É–∑–∫–∞ TFLite –º–æ–¥–µ–ª–∏
interpreter = tf.lite.Interpreter(model_path='berserk_card_model_augmented.tflite')
interpreter.allocate_tensors()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()
```

## üÜò –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –∏ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Ä–∞–∑–º–µ—Ä—ã —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

–£–¥–∞—á–∏ –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞! üöÄ